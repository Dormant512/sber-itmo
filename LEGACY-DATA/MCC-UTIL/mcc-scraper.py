from bs4 import BeautifulSoup
import requests


def get_mcc(mcc):
    """Returns mcc pair from MCC-CODES.RU."""
    url = f"https://mcc-codes.ru/search/?q={mcc}"
    page = requests.get(url)

    soup = BeautifulSoup(page.content, 'html.parser')
    target = soup.find('a', class_="text-primary")
    if target:
        target = target.text.strip().split(": ")[1]
    else:
        return "\n"
    ans = f"'{mcc}': '{target}',\n"

    return ans


mcc_array = ['5811', '7829', '7996', '7699', '7929', '5950', '5172', '8111',
       '7393', '5681', '7998', '5946', '5571', '3010', '5983', '7278',
       '5611', '4411', '7394', '6513', '7273', '5655', '5300', '5969',
       '5072', '5967', '5734', '4582', '7372', '5970', '7216', '8641',
       '5131', '7534', '5532', '5199', '5561', '2741', '7210', '3501',
       '5045', '3042', '7933', '8050', '4214', '7395', '5697', '5094',
       '7338', '5310', '3553', '3655', '3381', '5817', '5111', '3079',
       '5231', '5122', '3586', '8042', '5733', '3583', '5971', '7392',
       '6533', '4225', '6211', '5137', '8661', '5013', '5994', '5940',
       '7032', '7211', '5996', '3520', '5099', '5976', '7361', '3015',
       '7251', '3246', '5065', '7531', '7932', '3047', '3136', '3604',
       '3026', '5169', '7333', '7375', '7629', '1750', '5718', '5085',
       '3357', '763', '5932', '5074', '3649', '5713', '3008', '5044',
       '8211', '1799', '5198', '5521', '8351', '9405', '5021', '7379',
       '3533', '5047', '3831', '5960', '8244', '5972', '7535', '7261',
       '8699', '1740', '3642', '3005', '7631', '3007', '7622', '3211',
       '3615', '7297', '6532', '5271', '1711', '5933', '5599', '7911',
       '8675', '3034', '5818', '3182', '7277', '6537', '5139', '3509',
       '8931', '3530', '8241', '4119', '3504', '5978', '3674', '5973',
       '3502', '9211', '3612', '5051', '4468', '7321', '5046', '7623',
       '3028', '3068', '5962', '8249', '5975', '3678', '0', '3016',
       '1761', '4829', '3035', '3590', '5551', '5698', '7012', '7349',
       '5531', '3217', '3405', '4011', '5965', '3640', '780', '8651',
       '3301', '3366', '3621', '3665', '3013', '7296', '7033', '8911',
       '1520', '1731', '3180', '3389', '3543', '3245', '3206', '3029',
       '4457', '5966', '3051', '3641', '3654', '3643', '7993', '3261',
       '3001', '3798', '3703', '2842', '7339', '8049', '3750', '3351',
       '3075', '3690', '3526', '3400', '5998', '3355', '3503', '3716',
       '3077', '3770', '3387', '3579', '3813', '3088', '3742', '7217',
       '3030', '3780', '3811', '7276', '2791', '3672', '5963', '3692',
       '3102', '3006', '3032', '3050', '7519', '7992', '5997', '3710',
       '5937', '3512', '8734', '3548', '3589', '3634', '3778', '3161',
       '6050', '8031', '3256', '3058', '3089', '5935', '3618', '7641',
       '7342', '8041', '6555', '5262', '9406', '7692', '3535', '7513',
       '3266', '3835', '3542']


with open("./MCC_MAP.txt", 'w', newline='') as txtfile:
    txtfile.write("group_map = {\n")
    for item in mcc_array:
        pair = get_mcc(item)
        txtfile.write(pair)
    txtfile.write("}")
    
    
